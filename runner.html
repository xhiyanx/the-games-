<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Running Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  background: #222;
  color: white;
  text-align: center;
  font-family: Arial;
}

canvas {
  background: #444;
  display: block;
  margin: auto;
}

#ui {
  position: fixed;
  top: 10px;
  left: 10px;
  font-size: 18px;
}

#mobileControls {
  position: fixed;
  bottom: 10px;
  width: 100%;
  display: flex;
  justify-content: space-around;
}

#mobileControls button {
  width: 30%;
  font-size: 20px;
  padding: 15px;
  border-radius: 10px;
}
</style>
</head>

<body>

<div id="ui">
  Coins: <span id="coins">0</span><br>
  Shield: <span id="shield">1</span>
</div>

<canvas id="game" width="360" height="500"></canvas>

<div id="mobileControls">
  <button onclick="moveLeft()">â¬…</button>
  <button onclick="activateShield()">ðŸ›¡</button>
  <button onclick="moveRight()">âž¡</button>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let lane = 1; // 0 left, 1 middle, 2 right
let speed = 3;
let coins = 0;
let shields = 1;
let shieldActive = false;

const player = { y: 420, size: 30 };

let obstacles = [];
let coinItems = [];

function spawnRow() {
  let freeLane = Math.floor(Math.random() * 3);
  for (let i = 0; i < 3; i++) {
    if (i !== freeLane) {
      obstacles.push({ lane: i, y: -40 });
    } else if (Math.random() < 0.7) {
      coinItems.push({ lane: i, y: -40 });
    }
  }
}

setInterval(spawnRow, 1200);

function moveLeft() {
  if (lane > 0) lane--;
}

function moveRight() {
  if (lane < 2) lane++;
}

function activateShield() {
  if (shields > 0 && !shieldActive) {
    shields--;
    shieldActive = true;
    setTimeout(() => shieldActive = false, 3000);
    document.getElementById("shield").innerText = shields;
  }
}

document.addEventListener("keydown", e => {
  if (e.key === "ArrowLeft") moveLeft();
  if (e.key === "ArrowRight") moveRight();
  if (e.key === " ") activateShield();
});

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // lanes
  for (let i = 1; i < 3; i++) {
    ctx.fillStyle = "#555";
    ctx.fillRect(i * 120, 0, 2, canvas.height);
  }

  // player
  ctx.fillStyle = shieldActive ? "cyan" : "yellow";
  ctx.fillRect(lane * 120 + 45, player.y, player.size, player.size);

  // obstacles
  ctx.fillStyle = "red";
  obstacles.forEach(o => {
    o.y += speed;
    ctx.fillRect(o.lane * 120 + 45, o.y, 30, 30);

    if (
      o.lane === lane &&
      o.y + 30 > player.y &&
      o.y < player.y + 30
    ) {
      if (shieldActive) {
        o.y = 1000;
      } else {
        alert("Game Over!");
        location.reload();
      }
    }
  });

  // coins
  ctx.fillStyle = "gold";
  coinItems.forEach(c => {
    c.y += speed;
    ctx.beginPath();
    ctx.arc(c.lane * 120 + 60, c.y + 15, 10, 0, Math.PI * 2);
    ctx.fill();

    if (
      c.lane === lane &&
      c.y + 20 > player.y &&
      c.y < player.y + 30
    ) {
      coins++;
      c.y = 1000;
      document.getElementById("coins").innerText = coins;
    }
  });

  speed += 0.0005;
  requestAnimationFrame(draw);
}

draw();
</script>

</body>
</html>
